# Decision Rationale â€” database/05-alembic-migrations.md

> **Corresponds to**: [`docs/agent-context/database/05-alembic-migrations.md`](../../agent-context/database/05-alembic-migrations.md)
>
> When a decision changes in either file, update the other.

---

## Decision Alignment

This subcontext operationalizes schema integrity decisions as:

- Explicit initial migration (not blind autogeneration).
- pgvector extension setup in schema bootstrap.
- Evidence-chain trigger creation and immutability permissions.
- Upgrade/downgrade round-trip validation.

---

## Decision: Explicit migrations for audit-critical schema

**Why this is correct**

- Audit features (trigger + permissions) are too important to leave to autogenerated diffs.
- Keeps the schema reproducible across clean environments.
- Reduces drift between model intent and actual DB controls.

**Risk**

- Handwritten migrations can miss model evolution if discipline slips.

**Guardrail**

- Require migration tests for `upgrade -> downgrade -> upgrade` round-trips.
- Validate trigger existence and evidence immutability grants in tests.
- Keep migration review mandatory for evidence-related tables.

**Verdict**: **Keep with guardrail**
